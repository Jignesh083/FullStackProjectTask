<div class="dashboard-container">
  <!-- Main Content -->
  <main class="main-content">
    <!-- Top Navbar -->
    <div class="navbar">
      <h1>User Details</h1>
      <div class="button-group">
        <button (click)="onRegister()" class="profile-btn">User Registration</button>
        <button (click)="logout()" class="logout-btn">Logout</button>
      </div>
    </div>

    <!-- Filter Section -->
    <div class="filter-container">
      <select [(ngModel)]="selectedFilter" class="filter-dropdown">
        <option value="name">Name</option>
        <option value="email">Email</option>
        <option value="phone">Phone</option>
        <option value="dob">Date of Birth</option>
        <option value="gender">Gender</option>
        <option value="address">Address</option>
        <option value="country">Country</option>
      </select>
      <input type="text" [(ngModel)]="searchText" placeholder="Enter value to filter..." class="filter-input">

      <!-- Multi-Select State -->
      <ng-multiselect-dropdown 
  [placeholder]="'Select States'"
  [data]="uniqueState" 
  [(ngModel)]="filterCriteria.state"
  [settings]="dropdownSettings" 
  (onSelect)="onStateChange()" 
  (onDeSelect)="onStateChange()" 
  (onSelectAll)="onStateChange()" 
  (onDeSelectAll)="onStateChange()">
</ng-multiselect-dropdown>

<ng-multiselect-dropdown 
  [placeholder]="'Select Districts'" 
  [data]="uniqueDistricts"
  [(ngModel)]="selectedDistricts" 
  [settings]="dropdownSettings" 
  [disabled]="!selectedStates.length"
  (onSelect)="onDistrictChange()" 
  (onDeSelect)="onDistrictChange()" 
  (onSelectAll)="onDistrictChange()" 
  (onDeSelectAll)="onDistrictChange()">
</ng-multiselect-dropdown> 

<ng-multiselect-dropdown 
  [placeholder]="'Select Talukas'" 
  [data]="uniqueTalukas"
  [(ngModel)]="filterCriteria.taluka" 
  [settings]="dropdownSettings" 
  [disabled]="!selectedDistricts.length"
  (onSelect)="onTalukaChange()" 
  (onDeSelect)="onTalukaChange()" 
  (onSelectAll)="onTalukaChange()" 
  (onDeSelectAll)="onTalukaChange()">
</ng-multiselect-dropdown>

<ng-multiselect-dropdown 
  [placeholder]="'Select Villages'" 
  [data]="uniqueVillages"
  [(ngModel)]="filterCriteria.village" 
  [settings]="dropdownSettings" 
  [disabled]="!selectedTalukas.length">
</ng-multiselect-dropdown>


      <button (click)="applyFilter()" class="filter-btn">Filter</button>
      <button (click)="clearFilter()" class="clear-btn">Clear</button>
    </div>


    <div class="table-container">
      <h3>Users List</h3>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Date of Birth</th>
            <th>Gender</th>
            <th>Address</th>
            <th>Country</th>
            <th>State</th>
            <th>District</th>
            <th>Taluka</th>
            <th>Village</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of filteredUsers">
            <td>{{ user.name }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.phone }}</td>
            <td>{{ user.dob }}</td>
            <td>{{ user.gender }}</td>
            <td>{{ user.address }}</td>
            <td>{{ user.country }}</td>
            <td>{{ user.state }}</td>
            <td>{{ user.district }}</td>
            <td>{{ user.taluka }}</td>
            <td>{{ user.village }}</td>
            <td>
              <button (click)="editUser(user)" class="edit-btn">Edit</button>
              <button (click)="deleteUser(user.id)" class="delete-btn">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Update Form (Hidden until user clicks "Edit") -->
    <div *ngIf="editingUser" class="update-form">
      <h2>Update User</h2>
      <form [formGroup]="updateForm" (ngSubmit)="updateUser()">
        <label>Name: <input formControlName="name" type="text"></label>
        <label>Email: <input formControlName="email" type="email"></label>
        <label>Phone: <input formControlName="phone" type="text"></label>
        <label>Date of Birth: <input formControlName="dob" type="date"></label>
        <label>Gender:
          <select formControlName="gender">
            <option value="Male">Male</option>
            <option value="Female">Female</option>
          </select>
        </label>
        <label>Address: <input formControlName="address" type="text"></label>
        <label>Country: <input formControlName="country" type="text"></label>
        <button type="submit">Update</button>
        <button type="button" (click)="cancelEdit()">Cancel</button>
      </form>
    </div>
  </main>
</div>